"CH" = "CH, Orchards*"
)) +
labs(x = "Datasets",
y = "Number of Substances",
fill = "Farming System")+
coord_flip()+
theme_minimal()+
theme(legend.position = "bottom")+
stat_pvalue_manual(
pw_wilcox_det_pos %>% filter(p.adj <= 0.05),
label = "p.adj.signif",   # "***", "**", "*"
hide.ns = TRUE,
tip.length = 0.01,
bracket.size = 0.4,
step.increase = 0.07,
inherit.aes = FALSE
)
comparison_boxplot_number_of_detections
pw_wilcox_conc <- sprint_thesis_combined_tot_conc_plot %>%
group_by(dataset) %>%
pairwise_wilcox_test(total_concentrations ~ farming_system, p.adjust.method = "BH")
pw_wilcox_conc_pos <- pw_wilcox_conc %>%
add_xy_position(x = "dataset", dodge = 0.9)
comparison_boxplot_tot_concentrations <- ggplot(data = sprint_thesis_combined_tot_conc_plot,
aes(x = dataset,y = total_concentrations, fill = farming_system))+
geom_boxplot() +
stat_boxplot(geom ='errorbar',position = position_dodge(width = 0.9)) +
ggtitle("Total Concentration of Detected Substances on Investigated Plots from SPRINT & Thesis")+
stat_summary(
fun = mean,
geom = "crossbar",
linetype = "dashed",
width = 0.5,        # diamond shape
color = "red",
fill = "white"
)+
scale_fill_manual(values = fs_colour_plus,
labels = c("Regenerative", "Conventional", "Organic"))+
scale_x_discrete(labels = c(
"Thesis" = "Thesis, Oilseed Rape",
"CZ" = "CZ, Oil Plants*",
"CH" = "CH, Orchards*"
)) +
scale_y_continuous(trans = "log10")+
labs(x = "Datasets",
y = "Total Concentrations [ng/g]",
fill = "Farming System")+
coord_flip()+
theme_minimal()+
theme(legend.position = "bottom")+
stat_pvalue_manual(
pw_wilcox_det_pos %>% filter(p.adj <= 0.05),
label = "p.adj.signif",   # "***", "**", "*"
hide.ns = TRUE,
tip.length = 0.01,
bracket.size = 0.4,
step.increase = 0.07,
inherit.aes = FALSE
)
comparison_boxplot_tot_concentrations
pw_wilcox_conc <- sprint_thesis_combined_tot_conc_plot %>%
group_by(dataset) %>%
pairwise_wilcox_test(total_concentrations ~ farming_system, p.adjust.method = "BH")
pw_wilcox_conc_pos <- pw_wilcox_conc %>%
add_xy_position(x = "dataset", dodge = 0.9)
comparison_boxplot_tot_concentrations <- ggplot(data = sprint_thesis_combined_tot_conc_plot,
aes(x = dataset,y = total_concentrations, fill = farming_system))+
geom_boxplot() +
stat_boxplot(geom ='errorbar',position = position_dodge(width = 0.9)) +
ggtitle("Total Concentration of Detected Substances on Investigated Plots from SPRINT & Thesis")+
stat_summary(
fun = mean,
geom = "crossbar",
linetype = "dashed",
width = 0.5,        # diamond shape
color = "red",
fill = "white"
)+
scale_fill_manual(values = fs_colour_plus,
labels = c("Regenerative", "Conventional", "Organic"))+
scale_x_discrete(labels = c(
"Thesis" = "Thesis, Oilseed Rape",
"CZ" = "CZ, Oil Plants*",
"CH" = "CH, Orchards*"
)) +
scale_y_continuous(trans = "log10")+
labs(x = "Datasets",
y = "Total Concentrations [ng/g]",
fill = "Farming System")+
coord_flip()+
theme_minimal()+
theme(legend.position = "bottom")+
stat_pvalue_manual(
pw_wilcox_conc_pos %>% filter(p.adj <= 0.05),
label = "p.adj.signif",   # "***", "**", "*"
hide.ns = TRUE,
tip.length = 0.01,
bracket.size = 0.4,
step.increase = 0.07,
inherit.aes = FALSE
)
comparison_boxplot_tot_concentrations
pw_wilcox_conc <- sprint_thesis_combined_tot_conc_plot %>%
group_by(dataset) %>%
pairwise_wilcox_test(total_concentrations ~ farming_system, p.adjust.method = "BH")
pw_wilcox_conc_pos <- pw_wilcox_conc %>%
add_xy_position(x = "dataset", dodge = 0.9)
comparison_boxplot_tot_concentrations <- ggplot(data = sprint_thesis_combined_tot_conc_plot,
aes(x = dataset,y = total_concentrations, fill = farming_system))+
geom_boxplot() +
stat_boxplot(geom ='errorbar',position = position_dodge(width = 0.9)) +
ggtitle("Total Concentration of Detected Substances on Investigated Plots from SPRINT & Thesis")+
stat_summary(
fun = mean,
geom = "crossbar",
linetype = "dashed",
width = 0.5,        # diamond shape
color = "red",
fill = "white"
)+
scale_fill_manual(values = fs_colour_plus,
labels = c("Regenerative", "Conventional", "Organic"))+
scale_x_discrete(labels = c(
"Thesis" = "Thesis, Oilseed Rape",
"CZ" = "CZ, Oil Plants*",
"CH" = "CH, Orchards*"
)) +
scale_y_continuous(trans = "log10")+
labs(x = "Datasets",
y = "Total Concentrations [ng/g]",
fill = "Farming System")+
coord_flip()+
theme_minimal()+
theme(legend.position = "bottom")+
stat_pvalue_manual(
pw_wilcox_conc_pos %>% filter(p.adj <= 0.05),
label = "p.adj.signif",   # "***", "**", "*"
hide.ns = TRUE,
tip.length = 0.01,
bracket.size = 0.4,
step.increase = 0.07,
inherit.aes = FALSE
)
comparison_boxplot_tot_concentrations
comparison_boxplot_number_of_detections
pw_wilcox_conc_pos <- pw_wilcox_conc %>%
add_xy_position(x = "dataset", dodge = 0.9)
comparison_boxplot_tot_concentrations <- ggplot(data = sprint_thesis_combined_tot_conc_plot,
aes(x = dataset,y = total_concentrations, fill = farming_system))+
geom_boxplot() +
stat_boxplot(geom ='errorbar',position = position_dodge(width = 0.9)) +
ggtitle("Total Concentration of Detected Substances on Investigated Plots from SPRINT & Thesis")+
stat_summary(
fun = mean,
geom = "crossbar",
linetype = "dashed",
width = 0.5,        # diamond shape
color = "red",
fill = "white"
)+
scale_fill_manual(values = fs_colour_plus,
labels = c("Regenerative", "Conventional", "Organic"))+
scale_x_discrete(labels = c(
"Thesis" = "Thesis, Oilseed Rape",
"CZ" = "CZ, Oil Plants*",
"CH" = "CH, Orchards*"
)) +
scale_y_continuous(trans = "log10")+
labs(x = "Datasets",
y = "Total Concentrations [ng/g]",
fill = "Farming System")+
coord_flip()+
theme_minimal()+
theme(legend.position = "bottom")+
stat_pvalue_manual(
pw_wilcox_conc_pos %>% filter(p.adj <= 0.05),
label = "p.adj.signif",   # "***", "**", "*"
hide.ns = TRUE,
tip.length = 0.01,
bracket.size = 0.4,
step.increase = 0.07,
inherit.aes = FALSE
)
comparison_boxplot_tot_concentrations
comparison_boxplot_tot_concentrations <- ggplot(data = sprint_thesis_combined_tot_conc_plot,
aes(x = dataset,y = total_concentrations, fill = farming_system))+
geom_boxplot() +
stat_boxplot(geom ='errorbar',position = position_dodge(width = 0.9)) +
ggtitle("Total Concentration of Detected Substances on Investigated Plots from SPRINT & Thesis")+
stat_summary(
fun = mean,
geom = "crossbar",
linetype = "dashed",
width = 0.5,        # diamond shape
color = "red",
fill = "white"
)+
scale_fill_manual(values = fs_colour_plus,
labels = c("Regenerative", "Conventional", "Organic"))+
scale_x_discrete(labels = c(
"Thesis" = "Thesis, Oilseed Rape",
"CZ" = "CZ, Oil Plants*",
"CH" = "CH, Orchards*"
)) +
#scale_y_continuous(trans = "log10")+
labs(x = "Datasets",
y = "Total Concentrations [ng/g]",
fill = "Farming System")+
coord_flip()+
# >>> the displayed axis is now x (horizontal), so log-transform x:
scale_x_log10(
breaks = 10^(-2:3),                  # choose breaks that fit your data
labels = label_number(scale_cut = cut_short_scale())  # or use label_math(10^.x)
) +
theme_minimal()+
theme(legend.position = "bottom")+
stat_pvalue_manual(
pw_wilcox_conc_pos %>% filter(p.adj <= 0.05),
label = "p.adj.signif",   # "***", "**", "*"
hide.ns = TRUE,
tip.length = 0.01,
bracket.size = 0.4,
step.increase = 0.07,
inherit.aes = FALSE
)
pw_wilcox_rq_pos <- pw_wilcox_rq %>%
add_xy_position(x = "dataset", dodge = 0.9)
pw_wilcox_rq <- sprint_thesis_combined_rq_plot %>%
group_by(dataset) %>%
pairwise_wilcox_test(cumulative_rq ~ farming_system, p.adjust.method = "BH")
pw_wilcox_rq_pos <- pw_wilcox_rq %>%
add_xy_position(x = "dataset", dodge = 0.9)
comparison_boxplot_cumulative_rq <- ggplot(data = sprint_thesis_combined_rq_plot,
aes(x = dataset,y = cumulative_rq, fill = farming_system))+
geom_boxplot() +
stat_boxplot(geom ='errorbar',position = position_dodge(width = 0.9)) +
ggtitle("Cumulative Risk Quotient on Investigated Plots from SPRINT & Thesis")+
stat_summary(
fun = mean,
geom = "crossbar",
linetype = "dashed",
width = 0.5,        # diamond shape
color = "red",
fill = "white"
)+
scale_fill_manual(values = fs_colour_plus,
labels = c("Regenerative", "Conventional", "Organic"))+
scale_x_discrete(labels = c(
"Thesis" = "Thesis, Oilseed Rape",
"CZ" = "CZ, Oil Plants*",
"CH" = "CH, Orchards*"
)) +
scale_y_continuous(trans = "log10")+
labs(x = "Datasets",
y = "Cumulative Risk Quotient",
fill = "Farming System")+
coord_flip()+
theme_minimal()+
theme(legend.position = "bottom")+
stat_pvalue_manual(
pw_wilcox_rq_pos %>% filter(p.adj <= 0.05),
label = "p.adj.signif",   # "***", "**", "*"
hide.ns = TRUE,
tip.length = 0.01,
bracket.size = 0.4,
step.increase = 0.07,
inherit.aes = FALSE
)
comparison_boxplot_cumulative_rq
comparison_boxplot_cumulative_rq <- ggplot(data = sprint_thesis_combined_rq_plot,
aes(x = dataset,y = cumulative_rq, fill = farming_system))+
geom_boxplot() +
stat_boxplot(geom ='errorbar',position = position_dodge(width = 0.9)) +
ggtitle("Cumulative Risk Quotient on Investigated Plots from SPRINT & Thesis")+
stat_summary(
fun = mean,
geom = "crossbar",
linetype = "dashed",
width = 0.5,        # diamond shape
color = "red",
fill = "white"
)+
scale_fill_manual(values = fs_colour_plus,
labels = c("Regenerative", "Conventional", "Organic"))+
scale_x_discrete(labels = c(
"Thesis" = "Thesis, Oilseed Rape",
"CZ" = "CZ, Oil Plants*",
"CH" = "CH, Orchards*"
)) +
scale_y_continuous(trans = "log10")+
labs(x = "Datasets",
y = "Cumulative Risk Quotient",
fill = "Farming System")+
coord_flip()+
theme_minimal()+
theme(legend.position = "bottom")
comparison_boxplot_cumulative_rq
source("C:/Users/fcchr/OneDrive/Universitaet/MASTER/MasterThesis/11_Data_Analysis_MA/03_R/16_ppp_comparison_sprint.R", echo=TRUE)
View(pw_wilcox_det)
View(pw_wilcox_conc)
View(pw_wilcox_rq)
View(pw_all)
df <- sprint_thesis_combined_tot_conc_plot
# Combine factors
df <- df %>% mutate(group = interaction(farming_system, dataset, sep = "_"))
pw_all_conc
# Pairwise Wilcoxon across all systemâ€“dataset combos
pw_all_conc <- pairwise.wilcox.test(df$n_detected, df$group, p.adjust.method = "BH")
pw_all_conc
df <- sprint_thesis_combined_tot_conc_plot
# Combine factors
df <- df %>% mutate(group = interaction(farming_system, dataset, sep = "_"))
str(df)
# Pairwise Wilcoxon across all systemâ€“dataset combos
pw_all_conc <- pairwise.wilcox.test(df$total_concentrations, df$group, p.adjust.method = "BH")
pw_all_conc
df <- sprint_thesis_combined_rq_plot
# Combine factors
df <- df %>% mutate(group = interaction(farming_system, dataset, sep = "_"))
df <- sprint_thesis_combined_rq_plot
# Combine factors
df <- df %>% mutate(group = interaction(farming_system, dataset, sep = "_"))
# Pairwise Wilcoxon across all systemâ€“dataset combos
pw_all_conc <- pairwise.wilcox.test(df$cumulative_rq, df$group, p.adjust.method = "BH")
pw_all_conc
View(sprint_thesis_combined_freq_plot)
View(sprint_thesis_combined_freq_plot)
key_figures_det <- sprint_thesis_combined_freq_plot %>%
group_by(dataset,farming_system) %>%
summarise(med = median(n_detected,na.rm = TRUE),
average = mean(n_detected,na.rm = TRUE),
minimum = min(n_detected,na.rm = TRUE),
maximum = max(n_detected,na.rm = TRUE),
sd = sd(n_detected,na.rm = TRUE))
View(key_figures_det)
key_figures_det_dataset <- sprint_thesis_combined_freq_plot %>%
group_by(dataset,farming_system) %>%
summarise(med = median(n_detected,na.rm = TRUE),
average = mean(n_detected,na.rm = TRUE),
minimum = min(n_detected,na.rm = TRUE),
maximum = max(n_detected,na.rm = TRUE),
sd = sd(n_detected,na.rm = TRUE))
key_figures_det_dataset <- sprint_thesis_combined_freq_plot %>%
group_by(dataset) %>%
summarise(med = median(n_detected,na.rm = TRUE),
average = mean(n_detected,na.rm = TRUE),
minimum = min(n_detected,na.rm = TRUE),
maximum = max(n_detected,na.rm = TRUE),
sd = sd(n_detected,na.rm = TRUE))
View(key_figures_det_dataset)
#total concentrations
key_figures_conc <- sprint_thesis_combined_tot_conc_plot %>%
group_by(dataset,farming_system) %>%
summarise(med = median(total_concentrations,na.rm = TRUE),
average = mean(total_concentrations,na.rm = TRUE),
minimum = min(total_concentrations,na.rm = TRUE),
maximum = max(total_concentrations,na.rm = TRUE),
sd = sd(total_concentrations,na.rm = TRUE))
View(key_figures_conc)
key_figures_conc_dataset <- sprint_thesis_combined_tot_conc_plot %>%
group_by(dataset) %>%
summarise(med = median(total_concentrations,na.rm = TRUE),
average = mean(total_concentrations,na.rm = TRUE),
minimum = min(total_concentrations,na.rm = TRUE),
maximum = max(total_concentrations,na.rm = TRUE),
sd = sd(total_concentrations,na.rm = TRUE))
#cumulative RQ
key_figures_rq <- sprint_thesis_combined_rq_plot %>%
group_by(dataset,farming_system) %>%
summarise(med = median(cumulative_rq,na.rm = TRUE),
average = mean(cumulative_rq,na.rm = TRUE),
minimum = min(cumulative_rq,na.rm = TRUE),
maximum = max(cumulative_rq,na.rm = TRUE),
sd = sd(cumulative_rq,na.rm = TRUE))
key_figures_rq_dataset <- sprint_thesis_combined_rq_plot %>%
group_by(dataset) %>%
summarise(med = median(cumulative_rq,na.rm = TRUE),
average = mean(cumulative_rq,na.rm = TRUE),
minimum = min(cumulative_rq,na.rm = TRUE),
maximum = max(cumulative_rq,na.rm = TRUE),
sd = sd(cumulative_rq,na.rm = TRUE))
df <- sprint_thesis_combined_rq_plot
# Combine factors
df <- df %>% mutate(group = interaction(farming_system, dataset, sep = "_"))
# Pairwise Wilcoxon across all systemâ€“dataset combos
pw_all_rq <- pairwise.wilcox.test(df$cumulative_rq, df$group, p.adjust.method = "BH")
pw_all_rq
df <- sprint_thesis_combined_rq_plot
# Combine factors
df <- df %>% mutate(group = interaction(farming_system, dataset, sep = "_"))
# Pairwise Wilcoxon across all systemâ€“dataset combos
pw_all_rq <- pairwise.wilcox.test(df$cumulative_rq, df$group, p.adjust.method = "BH")
pw_all_rq
df <- sprint_thesis_combined_tot_conc_plot
# Combine factors
df <- df %>% mutate(group = interaction(farming_system, dataset, sep = "_"))
# Pairwise Wilcoxon across all systemâ€“dataset combos
pw_all_conc <- pairwise.wilcox.test(df$total_concentrations, df$group, p.adjust.method = "BH")
pw_all_conc
#2. between groups comparison wilcox####
df <- sprint_thesis_combined_freq_plot
# Combine factors
df <- df %>% mutate(group = interaction(farming_system, dataset, sep = "_"))
# Pairwise Wilcoxon across all systemâ€“dataset combos
pw_all_det <- pairwise.wilcox.test(df$n_detected, df$group, p.adjust.method = "BH")
pw_all_det
View(pw_all_det)
pw_all_det
View(key_figures_det_dataset)
View(key_figures_det)
View(pw_wilcox_det_pos)
View(pw_all_conc)
View(key_figures_conc)
pw_all_conc
View(pw_wilcox_conc)
View(key_figures_conc_dataset)
# Pairwise Wilcoxon across all systemâ€“dataset combos
pw_all_rq <- pairwise.wilcox.test(df$cumulative_rq, df$group, p.adjust.method = "BH")
pw_all_rq
df <- sprint_thesis_combined_rq_plot
# Combine factors
df <- df %>% mutate(group = interaction(farming_system, dataset, sep = "_"))
# Pairwise Wilcoxon across all systemâ€“dataset combos
pw_all_rq <- pairwise.wilcox.test(df$cumulative_rq, df$group, p.adjust.method = "BH")
pw_all_rq
View(key_figures_rq)
var <- "shi_total"   # choose any outcome
dfp <- combined_plant_soil_ra %>%
select(RA_average, !!sym(var)) %>%
na.omit() %>%
mutate(RA_rank  = rank(RA_average, ties.method = "average"),
var_rank = rank(.data[[var]], ties.method = "average"))
ggplot(dfp, aes(RA_rank, var_rank)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "rank(RA_score)", y = paste0("rank(", var, ")"),
title = paste("Rankâ€“rank plot (Spearman) for", var)) +
theme_minimal(base_size = 12)
ggplot(data=combined_plant_soil_ra_plot,aes(x=RA_average,y=`C%_normal`))+
geom_point()
#5. RA score distribution plots######
ra_distr_plot <-  read.xlsx(file.path(output_dir_reg_score,"total_ra_scores_per_field_certif.xlsx"))
df_plot_RA_score <- ra_distr_plot %>%
group_by(RA_score) %>%
arrange(participant, .by_group = TRUE) %>%
mutate(
n_at_x = n(),
y = if_else(
n_at_x == 1,
1,
1 + (row_number() - (n_at_x + 1) / 2) * 0.08  # tweak 0.08 for spacing
)
) %>%
ungroup()
RA_OSR <- ggplot(df_plot_RA_score, aes(x = RA_score, y = y, colour = factor(certif))) +
geom_point(size = 3) +
scale_color_manual(values = fs_colour_plus,
labels = c("Reg. Conv.","Conv.", "Reg. Org."))+
scale_x_continuous(breaks = 0:8, limits = c(-0.5, 8.5)) +
coord_cartesian(ylim = c(0.6, 1.4)) +
theme_minimal() +
theme(
axis.title.y = element_blank(),
axis.text.y  = element_blank(),
axis.ticks.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
legend.position = "bottom"
) +
labs(x = "RA Score (0â€“8)", title = "RA Scores per Field OSR Cultivation Period",
colour = "Management System")
df_plot_RA_average <- ra_distr_plot %>%
group_by(RA_average) %>%
arrange(participant, .by_group = TRUE) %>%
mutate(
n_at_x = n(),
y = if_else(
n_at_x == 1,
1,
1 + (row_number() - (n_at_x + 1) / 2) * 0.08  # tweak 0.08 for spacing
)
) %>%
ungroup()
RA_average <- ggplot(df_plot_RA_average, aes(x = RA_average, y = y,colour = factor(certif))) +
geom_point(size = 3) +
scale_color_manual(values = fs_colour_plus,
labels = c("Reg. Conv.","Conv.", "Reg. Org."))+
scale_x_continuous(breaks = 0:8, limits = c(-0.5, 8.5)) +
coord_cartesian(ylim = c(0.6, 1.4)) +
theme_minimal() +
theme(
axis.title.y = element_blank(),
axis.text.y  = element_blank(),
axis.ticks.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
legend.position = "bottom"
) +
labs(x = "RA Score (0â€“8)", title = "RA Scores per Field average of 4 Last Cultivation Periods",
colour = "Management System")
combined_plot <- RA_OSR +
theme(axis.title.x = element_blank())+
#axis.text.x  = element_blank())
RA_average+
plot_layout(ncol = 1,
heights = c(1, 1, 1),
guides ="collect") +
plot_annotation(tag_levels = 'a') &
theme(legend.position = "bottom")
combined_plot
ggsave(file.path(output_dir_reg_score,"RA_score_distribution_plots.png"),
width = 18, height = 16,units = "cm")
