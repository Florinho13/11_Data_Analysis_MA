#script for soil texture analysis
#Code created by Florian Christ as part of the Master Thesis
#used R Version. 4.4.1 2024-06-14 ucrt


#00_Setup_Environment######
#import libraries
library(tidyverse)
library(ggplot2)


#load project functions
source("./03_R/00_functions.R")

#import dataset
ph_clean <- readRDS("./01_input/pH_data_clean.rds")


# prepare dataset for plotting#####
ph_clean_rp <- ph_clean %>% 
  mutate(location = substr(sample_name,1,1),
         farming_system = substr(sample_name,3,3),
         plot = substr(sample_name,5,5))

location_colors <- map_colours(ph_clean_rp$location)

farming_system_shapes <- map_shapes(ph_clean_rp$farming_system)

ph_clean_rp$color <- location_colors[as.character(ph_clean_rp$location)] 
ph_clean_rp$shape <- farming_system_shapes[as.character(ph_clean_rp$farming_system)]

#02 create boxplots#####

pH_plot_overview <- ggplot(ph_clean_rp,aes(x=substr(sample_name,1,3),y=pH,pch=factor(shape),colour = factor(location)))+
  geom_point(stat = "identity", position = "identity")+
  ggtitle("pH values on the different field plots\
          and field average")+
  labs(y="pH",x="Field Numbers")+
  stat_summary(
    fun = mean, 
    geom = "point",
    aes(shape = "Mean Value"),
    shape = 8,
    color = "black",  # Color of the mean line (you can change this as needed)
    size = 2,) +# Thickness of the line
  scale_color_manual(values = location_colors, labels = c("Freudwil","Niederhasli","LÃ¤ufelfingen",
                                                          "Heimenhausen","Heimiswil","Ueberstorf"))+
  scale_shape_manual(values = c(16,17), labels = c("Regenerative","Conventional"))+
  labs(color = "Location",shape="Farming System")+
  theme_minimal()
ggsave("./02_output/pH_overview.png",pH_plot_overview,width = 15,height = 15,units = "cm")
  
  
  